#### **1. 核心三层结构：Package, Crate, Module**

这三者是不同层面的概念，不能混淆。

- **Package (包)**

  - **定义**: 一个由 `Cargo.toml` 文件定义的项目。是 Cargo 用来构建、测试和分享代码的最高单位。
  - **角色**: **项目管理器**。负责元数据、依赖管理和编译目标的定义。

- **Crate (单元包)**

  - **定义**: Rust 的**编译单元**。它被编译器 (`rustc`) 一次性编译成库或可执行文件。
  - **角色**: **编译器的工作单元**。

- **Module (模块)**
  - **定义**: 在单个 Crate 内部组织代码、控制作用域和可见性的方式。
  - **角色**: **代码的组织器**。

#### **2. Crate 的两种类型：库 vs. 二进制**

一个 Package 内可以包含一个库 Crate 和多个二进制 Crate。

- **Library Crate (库)**

  - **根文件**: `src/lib.rs`。
  - **目的**: 提供可复用的代码（函数、结构体等），供其他 Crate 使用。
  - **产物**: 一个库文件（`.rlib`, `.so`, `.dll`），不能独立运行。
  - **注**: 一个 Package 最多只能有一个库。

- **Binary Crate (二进制)**
  - **根文件**: `src/main.rs` (或 `src/bin/*.rs`)。
  - **目的**: 创建一个可直接运行的程序（**二进制可执行文件**）。
  - **产物**: 一个可执行文件（`.exe` 等）。
  - **注**: 必须包含 `fn main()` 作为程序入口。

#### **3. 模块化与可见性 (`mod` & `pub`)**

- **默认私有**: Rust 中所有条目（函数、模块、结构体等）默认都是私有的。
- **`mod` 关键字**: 用于**声明**一个模块的存在。它不是 `include`，只在模块树的相应位置声明一次。
- **`pub` 关键字**: 将条目标记为公有，使其对外部可见。

- **`pub struct` vs `pub enum` 的关键区别**:
  - `pub struct`: 只将**结构体本身**设为公有，其**字段默认仍是私有**的。这允许你通过隐藏部分字段来强制实现封装和保护“不变量”。如果结构体有私有字段，通常需要提供一个公有的构造函数（如 `::new()`）。
  - `pub enum`: 会将**枚举本身及其所有变体**都设为公有。因为如果变体不公有，外部代码将无法创建或匹配该枚举，使其变得毫无用处。

#### **4. 将模块拆分到文件**

`mod my_module;` 是一个声明，它会触发编译器按固定规则查找文件。

- **规则 1**: 在 `src/lib.rs` 或 `src/main.rs` 中 `mod foo;` -> 编译器查找 `src/foo.rs`。
- **规则 2**: 在 `src/foo.rs` 中 `mod bar;` -> 编译器查找 `src/foo/bar.rs`。
